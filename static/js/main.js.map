{"version":3,"sources":["../webpack/bootstrap","themes/index.ts","containers/about/index.tsx","util/hooks/useEventListener.tsx","util/hooks/useLocalStorage.tsx","services/ui/index.tsx","services/store.tsx","containers/helpers/loader.tsx","util/hooks/useInterval.tsx","containers/helpers/pinger.tsx","containers/helpers/saver.tsx","containers/helpers/index.tsx","containers/footer/stat-bar.tsx","containers/footer/stat-group.tsx","containers/footer/interactions/progress-bar.tsx","containers/footer/interactions/interaction-button.tsx","containers/footer/interactions/index.tsx","containers/footer/index.tsx","containers/pet-container/statuses.tsx","containers/pet-container/index.tsx","containers/header/header-bottom.tsx","containers/header/pet-tabs.tsx","containers/header/header-top.tsx","containers/header/index.tsx","containers/main.tsx","containers/app.tsx","reportWebVitals.ts","index.tsx","util/tools.tsx","util/whenthen.tsx","services/petstore/index.tsx"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","2","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","this","oldJsonpFunction","slice","createGlobalStyle","getColor","colorId","store","colors","getShade","colId","percent","color","R","parseInt","substring","G","B","Math","round","toString","black","grey","grey_light","white","blue","green","yellow","red","purple","shadows","z1","z2","z3","breakpoints","mobile_tiny","mobile_medium","mobile_large","tablet","desktop","mixinBubble","css","ScContainer","styled","div","ScLogo","h1","ScButton","button","About","useHistory","dispatch","useDispatch","onClick","clearSave","useEventListener","eventName","handler","element","savedHandler","useRef","useEffect","targetElement","current","window","addEventListener","eventListener","removeEventListener","useLocalStorage","initialValue","readValue","item","localStorage","getItem","JSON","parse","log","parseJSON","warn","useState","storedValue","setStoredValue","handleStorageChange","newValue","Function","setItem","stringify","dispatchEvent","Event","uiSlice","createSlice","initialState","reducers","actions","configureStore","reducer","petStore","petStoreReducer","ui","uiReducer","DEFAULT_LOCALSTORAGE_STATE","config","activePet","lastSaved","interactions","pets","fetchAllData","url","savedData","a","readManifest","fetchPetFiles","parsedPets","finishUp","fetchManifest","then","json","map","id","baseUrl","petsList","fetch","response","ok","text","jsonc","petFiles","forEach","pF","getPetPromise","petFile","fetchPetFile","petManifestEntry","petJson","now","Date","getTime","activeId","petDef","savedStatus","find","createPet","isActive","petDefinition","setActiveId","setActiveIdx","filter","interaction","endAt","thunkDispatch","restoreInteractionFromSave","removeInteractionEvent","Loader","loaded","setLoaded","useInterval","callback","delay","savedCallback","useLayoutEffect","setInterval","clearInterval","PING_RATE","Pinger","pinger","setPinger","pingStore","time","doSave","Saver","setLocalStorage","savePayload","useSelector","selectNewSavePayload","setCachedPayload","Helper","ScLabel","h4","ScBar","ScBarValue","span","ScBarFill","StatBar","label","max","hideStats","toLocaleUpperCase","style","width","ScStats","StatGroup","activeStats","selectRenderedDeltaStats","idx","ScWrapper","ScProgressBg","ScProgressBar","startWidth","ProgressBar","startProgress","duration","className","transition","ScInteraction","li","ScCooldownButton","InteractionButton","activeStatus","onClickHandler","total","startAt","progress","timeLeft","ScInteractions","ul","Interactions","interactionDefs","selectActiveInteractionDefinitions","shallowEqual","interactionStatus","selectActiveInteractionStatus","iS","addNewInteractionEvent","cooldown","addTemporaryInteraction","ScPetInfo","ScBio","ScBioName","ScBioInfo","Footer","petInfo","selectActiveInfo","bio","ScStatuses","ScStatus","props","background","borderAndText","mixinColorBubble","bubbleColors","getBubbleColors","alertType","Statuses","activeDeltaStatuses","selectDetailedActiveDeltaStatuses","dS","bottom","index","transform","random","bgImageUrl","ScPetImage","ScBehavior","PetContainer","activeBehavior","selectActiveBehavior","selectActiveBg","backgroundImage","imageUrl","backgroundPosition","position","left","offsetX","offsetY","ScPetLevel","ScPetName","ScBornOn","HeaderBottom","epoch","bornOn","toLocaleString","level","ScTabs","ScTab","PetTabs","petList","selectPetList","ScHelpButton","HeaderTop","ScHeader","header","ScTop","ScBottom","Header","ScBody","ScFooter","Main","App","path","reportWebVitals","onPerfEntry","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","number","pad","rounder","pow","clamp","val","min","getStatValue","cachedPetStats","timeDiff","forceCurrent","curValue","cS","perSecond","getRenderedDeltaStats","stats","oldSaveTime","newSaveTime","getCachedDeltaStats","evaluateWhenThenNumberGroup","whenThenNumberGroup","referenceValue","maxValue","when","w","evaluateWhenNumber","evaluateWhenThenStringGroup","whenThenStringGroup","stringCriteria","indexOf","parseRawWhenThenGroup","rawWhenThenGroup","rwt","parseExpressionString","EXPRESSION_MAP","v","expressionString","valueTokens","split","condition","percentageSplit","criteria","Number","isPercent","whenNumber","reference","referenceMax","initialStoreState","activeIdx","cachedPets","lastRendered","parsePetBehaviors","petBehaviorsJson","pB","image","parseStatChanges","statChangesJSON","sE","statId","parseInteractionsGroup","int","changeStats","parseStatsGroup","statsDef","pS","foundStat","statEffects","getUpdatedStats","statDefinitions","newStats","getNewValue","cachedStat","statDefs","changeDefs","found","cD","rawNew","sD","oldStat","hackySave","state","explicitTime","nowTime","petStoreSlice","action","payload","global","clear","location","reload","petIdx","findIndex","lsState","iE","cachedIdx","cP","cachedStats","logic","intId","foundPet","logicGroup","petDefJSON","statuses","behaviorRules","behaviors","parseLogicGroup","beingTracked","updatedDef","bgImage","selectActiveIdx","selectPets","getCachedPets","selectLastSaved","createSelector","selectLastRendered","selectActivePet","selectActiveStatDefinitions","selectActiveStatusDefinitions","selectActiveBehaviorRuleDefinitions","selectActiveBehaviorDefinitions","selectCachedPets","selectActiveCachedPetStats","cp","activeInteractions","selectActiveLastCached","petTime","selectActiveDeltaStatuses","activeInteractionDefinitions","iD","aI","deltaStats","findDeltaStat","ds","allStatuses","status","statusId","reverse","deltaStatIds","statusDefinitions","dId","deltaStatusIds","behaviorDefinitions","finalBehaviorId","f","bD","selectCachedDeltaStats","petStats","lastCachedTime","lastSavedTime","getFromLocalStorage","cachedDeltaStats","storedPets","newList","sP","curStats","concat"],"mappings":"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","file":"static/js/main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t2: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"static/js/\" + ({}[chunkId]||chunkId) + \".\" + {\"4\":\"d9fcdca6\"}[chunkId] + \".chunk.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = this[\"webpackJsonptly-browserpet\"] = this[\"webpackJsonptly-browserpet\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([63,3]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { createGlobalStyle, css } from 'styled-components';\r\n\r\nexport default createGlobalStyle`\r\n  *{\r\n    margin: 0;\r\n    padding: 0;\r\n    outline:0;\r\n    box-sizing:border-box;\r\n  }\r\n\r\n  /* prevent text selection */\r\n  * {\r\n    -webkit-touch-callout: none; /* iOS Safari */\r\n      -webkit-user-select: none; /* Safari */\r\n      -khtml-user-select: none; /* Konqueror HTML */\r\n        -moz-user-select: none; /* Firefox */\r\n          -ms-user-select: none; /* Internet Explorer/Edge */\r\n              user-select: none; /* Non-prefixed version, currently\r\n                                    supported by Chrome and Opera */\r\n    -webkit-tap-highlight-color: rgba(0,0,0,0);\r\n    -webkit-tap-highlight-color: transparent;\r\n  }\r\n  \r\n  #root{\r\n    margin:0 auto;\r\n    /* for chrome extension */\r\n    min-width:35rem;\r\n    min-height:65rem;\r\n  }\r\n  h1, h2, h3, h4, h5, h6{\r\n    font-family: 'Bevan', cursive;\r\n  }\r\n  a, p, span {\r\n    font-family: 'Cabin', sans-serif;\r\n  }\r\n  h1{\r\n    font-size: 5rem;\r\n  }\r\n  h2{\r\n    font-size: 4rem;\r\n  }\r\n  h3{\r\n    font-size: 3.5rem;\r\n  }\r\n  h4{\r\n    font-size: 2.5rem;\r\n  }\r\n  h5{\r\n    font-size: 1.5rem;\r\n  }\r\n  p, span{\r\n    font-size:1.5rem;\r\n    line-height: 1.5rem;\r\n  }\r\n\r\n  html{\r\n    font-size: 62.5%;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n    font-family: 'Cabin', sans-serif;\r\n    background-color: black;\r\n    color: white;\r\n  }\r\n  \r\n  code {\r\n    font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New', monospace;\r\n  }\r\n`\r\n\r\n/*\r\nexport const mixinFontFamily = (style) => {\r\n  switch(style){\r\n    case 'details' : return css`font-family: 'Roboto', sans-serif`;\r\n    case 'display': return css`font-family: 'Bevan', cursive`;\r\n    default: return css`font-family: 'Roboto', sans-serif`;\r\n  }\r\n}\r\n*/\r\nexport const listColors = () => {\r\n  return Object.keys(store.colors);\r\n}\r\n\r\n\r\nexport const getColor = (colorId: tColor) => {\r\n  return store.colors[colorId] as CssString; \r\n}\r\n\r\nexport const getShadow = (shadowId: tShadow) => {\r\n  return store.shadows[shadowId] as CssString;\r\n}\r\n\r\nexport const getBreakpoint = (breakpointId: tBreakpoint) => {\r\n  return store.breakpoints[breakpointId] as CssString;\r\n}\r\n\r\n/* from pablo on https://stackoverflow.com/questions/5560248/programmatically-lighten-or-darken-a-hex-color-or-rgb-and-blend-colors */\r\nexport const getShade = (colId: tColor, percent: number) => {\r\n  const color = colors[colId] || colId;\r\n\r\n  let R = parseInt(color.substring(1,3),16);\r\n  let G = parseInt(color.substring(3,5),16);\r\n  let B = parseInt(color.substring(5,7),16);\r\n\r\n  R = Math.round(R * (100 + percent) / 100);\r\n  G = Math.round(G * (100 + percent) / 100);\r\n  B = Math.round(B * (100 + percent) / 100);\r\n\r\n  R = (R<255)?R:255;  \r\n  G = (G<255)?G:255;  \r\n  B = (B<255)?B:255;  \r\n\r\n  const RR = ((R.toString(16).length===1)?\"0\"+R.toString(16):R.toString(16));\r\n  const GG = ((G.toString(16).length===1)?\"0\"+G.toString(16):G.toString(16));\r\n  const BB = ((B.toString(16).length===1)?\"0\"+B.toString(16):B.toString(16));\r\n\r\n  return \"#\"+RR+GG+BB;\r\n}\r\n\r\ntype CssString = string;\r\n\r\ntype tShadow = 'z1' | 'z2' | 'z3';\r\nconst shadows = {\r\n  z1: '-0.1rem 0.1rem .25rem .1rem rgba(0,0,0,0.16)',\r\n  z2: '-0.1rem 0.1rem .25rem .1rem rgba(0,0,0,0.36)',\r\n  z3: '-.2rem .5rem 1rem .2rem rgba(0,0,0,.36)'\r\n}\r\nexport type tColor = 'black' | 'grey' | 'grey_light' | 'white' | 'blue' | 'green' | 'yellow' | 'red' | 'purple';\r\nconst colors = {\r\n  black: '#000000',\r\n  grey: '#373737',\r\n  grey_light: '#A39F8E',\r\n  white: '#fef8dd',\r\n  blue: '#1fb9f3',\r\n  green: '#51f249',\r\n  yellow: '#fff249',\r\n  red: '#F55658',\r\n  purple: '#6b1ff3'\r\n}\r\n\r\ntype tBreakpoint = 'mobile_tiny' | 'mobile_medium' | 'mobile_large' | 'tablet' | 'desktop';\r\nconst breakpoints = {\r\n  mobile_tiny: '300px',\r\n  mobile_medium: '400px',\r\n  mobile_large: '500px',\r\n  tablet: '768px',\r\n  desktop: '1024px'\r\n}\r\n\r\ntype ThemeStore = {\r\n  colors: typeof colors,\r\n  shadows: typeof shadows,\r\n  breakpoints: typeof breakpoints\r\n}\r\n\r\nexport const store: ThemeStore = {\r\n  colors: colors,\r\n  shadows: shadows,\r\n  breakpoints: breakpoints\r\n}\r\n\r\n\r\nexport const mixinFontFamily = (style: 'details'|'display') => {\r\n  switch(style){\r\n    case 'details' : return css`font-family: 'Roboto', sans-serif`;\r\n    case 'display': return css`font-family: 'Bevan', cursive`;\r\n    default: return css`font-family: 'Roboto', sans-serif`;\r\n  }\r\n}\r\n\r\nexport const mixinBubble = () => {\r\n  return css`\r\n    border-radius:2rem;\r\n    border: .5rem solid;\r\n  `\r\n}\r\n\r\nexport const mixinColorBubble = (background: tColor, borderAndText: tColor = 'white') => {\r\n  return css`\r\n    ${mixinBubble()}\r\n    border-color: ${getColor(borderAndText)};\r\n    color: ${getColor(borderAndText)};\r\n    background-color: ${getColor(background)};\r\n  `\r\n}\r\n","import React from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { getColor } from '../../themes/';\r\n\r\nimport styled from 'styled-components';\r\nimport { clearSave } from '../../services/petstore';\r\nimport { useDispatch } from 'react-redux';\r\n\r\nconst ScContainer = styled.div`\r\n  padding:1rem;\r\n  color: ${getColor('blue')};\r\n  min-width:30rem;\r\n`;\r\n\r\nconst ScLogo = styled.h1`\r\n  font-size:2rem;\r\n  text-align:left;\r\n`;\r\n\r\nconst ScButton = styled.button`\r\n  border:0;\r\n  margin:0;\r\n  font-size:2rem;\r\n  padding:.5rem 1rem;\r\n  background-color: ${getColor('green')};\r\n  border: .5rem solid ${getColor('white')};\r\n  border-radius: 1rem;\r\n\r\n  margin-top:2rem;\r\n  text-align:center;\r\n  cursor:pointer;\r\n`\r\n\r\nexport const About = () => {\r\n  let { push } = useHistory();\r\n  const dispatch = useDispatch();\r\n\r\n\r\n  return (\r\n    <ScContainer>\r\n      <ScLogo>{'About BrowserPet'}</ScLogo>\r\n      <p>{'© Tom Yancey 2022'}</p>\r\n      <ScButton onClick={() => {push('/')}}>\r\n        {'BACK'}\r\n      </ScButton>\r\n      <ScButton onClick={() => {dispatch(clearSave())}}>\r\n        {'Clear Save'}\r\n      </ScButton>\r\n    </ScContainer>\r\n  )\r\n}\r\n\r\n","import { RefObject, useEffect, useRef } from 'react'\r\n\r\nfunction useEventListener<K extends keyof WindowEventMap>(\r\n  eventName: K,\r\n  handler: (event: WindowEventMap[K]) => void,\r\n): void\r\nfunction useEventListener<\r\n  K extends keyof HTMLElementEventMap,\r\n  T extends HTMLElement = HTMLDivElement,\r\n>(\r\n  eventName: K,\r\n  handler: (event: HTMLElementEventMap[K]) => void,\r\n  element: RefObject<T>,\r\n): void\r\n\r\nfunction useEventListener<\r\n  KW extends keyof WindowEventMap,\r\n  KH extends keyof HTMLElementEventMap,\r\n  T extends HTMLElement | void = void,\r\n>(\r\n  eventName: KW | KH,\r\n  handler: (\r\n    event: WindowEventMap[KW] | HTMLElementEventMap[KH] | Event,\r\n  ) => void,\r\n  element?: RefObject<T>,\r\n) {\r\n  // Create a ref that stores handler\r\n  const savedHandler = useRef<typeof handler>()\r\n\r\n  useEffect(() => {\r\n    // Define the listening target\r\n    // TLY: couldn't figure out how to get the T to not have a compile issue with 'addEventListener'\r\n    // const targetElement: T | Window = element?.current || window\r\n    const targetElement: any = element?.current || window\r\n    if (!(targetElement && targetElement.addEventListener)) {\r\n      return\r\n    }\r\n\r\n    // Update saved handler if necessary\r\n    if (savedHandler.current !== handler) {\r\n      savedHandler.current = handler\r\n    }\r\n\r\n    // Create event listener that calls handler function stored in ref\r\n    const eventListener: typeof handler = event => {\r\n      // eslint-disable-next-line no-extra-boolean-cast\r\n      if (!!savedHandler?.current) {\r\n        savedHandler.current(event)\r\n      }\r\n    }\r\n\r\n    targetElement.addEventListener(eventName, eventListener)\r\n\r\n    // Remove event listener on cleanup\r\n    return () => {\r\n      targetElement.removeEventListener(eventName, eventListener)\r\n    }\r\n  }, [eventName, element, handler])\r\n}\r\n\r\nexport default useEventListener","// https://usehooks-ts.com/react-hook/use-local-storage\r\nimport { Dispatch, SetStateAction, useEffect, useState } from 'react'\r\n\r\n// See: https://usehooks-ts.com/react-hook/use-event-listener\r\nimport useEventListener from './useEventListener'\r\n\r\ndeclare global {\r\n  interface WindowEventMap {\r\n    'local-storage': CustomEvent\r\n  }\r\n}\r\n\r\ntype SetValue<T> = Dispatch<SetStateAction<T>>\r\n\r\nfunction useLocalStorage<T>(key: string, initialValue: T): [T, SetValue<T>] {\r\n  // Get from local storage then\r\n  // parse stored json or return initialValue\r\n  const readValue = (): T => {\r\n    // Prevent build error \"window is undefined\" but keep keep working\r\n    if (typeof window === 'undefined') {\r\n      return initialValue\r\n    }\r\n\r\n    try {\r\n      const item = window.localStorage.getItem(key)\r\n      return item ? (parseJSON(item) as T) : initialValue\r\n    } catch (error) {\r\n      console.warn(`Error reading localStorage key “${key}”:`, error)\r\n      return initialValue\r\n    }\r\n  }\r\n\r\n  // State to store our value\r\n  // Pass initial state function to useState so logic is only executed once\r\n  const [storedValue, setStoredValue] = useState<T>(readValue)\r\n\r\n  // Return a wrapped version of useState's setter function that ...\r\n  // ... persists the new value to localStorage.\r\n  const setValue: SetValue<T> = value => {\r\n    // Prevent build error \"window is undefined\" but keeps working\r\n    if (typeof window == 'undefined') {\r\n      console.warn(\r\n        `Tried setting localStorage key “${key}” even though environment is not a client`,\r\n      )\r\n    }\r\n\r\n    try {\r\n      // Allow value to be a function so we have the same API as useState\r\n      const newValue = value instanceof Function ? value(storedValue) : value\r\n\r\n      // Save to local storage\r\n      window.localStorage.setItem(key, JSON.stringify(newValue))\r\n\r\n      // Save state\r\n      setStoredValue(newValue)\r\n\r\n      // We dispatch a custom event so every useLocalStorage hook are notified\r\n      window.dispatchEvent(new Event('local-storage'))\r\n    } catch (error) {\r\n      console.warn(`Error setting localStorage key “${key}”:`, error)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    setStoredValue(readValue())\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [])\r\n\r\n  const handleStorageChange = () => {\r\n    setStoredValue(readValue())\r\n  }\r\n\r\n  // this only works for other documents, not the current one\r\n  useEventListener('storage', handleStorageChange)\r\n\r\n  // this is a custom event, triggered in writeValueToLocalStorage\r\n  // See: useLocalStorage()\r\n  useEventListener('local-storage', handleStorageChange)\r\n\r\n  return [storedValue, setValue]\r\n}\r\n\r\nexport default useLocalStorage\r\n\r\n// A wrapper for \"JSON.parse()\"\" to support \"undefined\" value\r\nfunction parseJSON<T>(value: string | null): T | undefined {\r\n  try {\r\n    return value === 'undefined' ? undefined : JSON.parse(value ?? '')\r\n  } catch (error) {\r\n    console.log('parsing error on', { value })\r\n    return undefined\r\n  }\r\n}\r\n","// slightly evolving from create-react-app example\r\nimport { createSlice } from '@reduxjs/toolkit';\r\n\r\nexport type UiSlice = {\r\n}\r\n\r\nconst initialState: UiSlice = {\r\n};\r\n\r\nexport const uiSlice = createSlice({\r\n  name: 'ui',\r\n  initialState,\r\n  reducers: {\r\n  }\r\n});\r\n\r\nexport const { } = uiSlice.actions;\r\n\r\nexport default uiSlice.reducer;\r\n","import { configureStore, ThunkAction, Action } from '@reduxjs/toolkit';\r\nimport { LocalStorageState } from '../types';\r\nimport petStoreReducer from './petstore';\r\nimport uiReducer from './ui';\r\n\r\nexport const store = configureStore({\r\n  reducer: {\r\n    petStore: petStoreReducer,\r\n    ui: uiReducer\r\n  },\r\n});\r\n\r\nexport type AppDispatch = typeof store.dispatch;\r\nexport type RootState = ReturnType<typeof store.getState>;\r\nexport type AppThunk<ReturnType = void> = ThunkAction<\r\n  ReturnType,\r\n  RootState,\r\n  unknown,\r\n  Action<string>\r\n>;\r\n\r\nexport const DEFAULT_LOCALSTORAGE_STATE: LocalStorageState = {\r\n  config:{\r\n    activePet: '',\r\n    lastSaved: -1\r\n  },\r\n  interactions:[],\r\n  pets:[]\r\n};","import { useEffect, useState } from 'react';\r\nimport { jsonc } from 'jsonc';\r\n\r\nimport { LocalStorageState, PetManifestEntry, RawPetJSON } from '../../types';\r\nimport useLocalStorage from '../../util/hooks/useLocalStorage';\r\nimport { createPet, removeInteractionEvent, restoreInteractionFromSave, setActiveId, setActiveIdx } from '../../services/petstore';\r\nimport { DEFAULT_LOCALSTORAGE_STATE } from '../../services/store';\r\nimport { useDispatch } from 'react-redux';\r\nimport { Dispatch } from '@reduxjs/toolkit';\r\n\r\n\r\nconst fetchAllData = async (url: string, dispatch: any, savedData: LocalStorageState) => {\r\n  console.log('\\n\\n\\n');\r\n  console.log('-------fetchAllData----------');\r\n  const pets = await readManifest(url)\r\n  console.log('fetchAllData: received pets', pets);\r\n\r\n  const parsedPets = await fetchPetFiles(pets)\r\n  console.log('fetchAllData: received parsedPets', parsedPets);\r\n\r\n  finishUp(parsedPets, dispatch, savedData)\r\n\r\n  console.log('\\n\\n\\n');\r\n}\r\n\r\nconst readManifest = async (url: string) => {\r\n  console.log(`readManifest: reading manifest from ${url}`);\r\n  const petsList = await fetchManifest(url).then(json => {\r\n    console.log('readManifest: fetched:', json);\r\n    return json.pets.map((p:any) => ({\r\n      id: p.id,\r\n      baseUrl: p.baseUrl\r\n    }));\r\n  });\r\n\r\n  console.log('readManifest: returning', petsList);\r\n  return petsList;\r\n}\r\n\r\nconst fetchManifest = async (url: string) => {\r\n  try{\r\n    const response = await fetch(url, { mode: 'cors'});\r\n    if(!response.ok){\r\n      throw `bad response`;\r\n    }\r\n    \r\n    const text = await response.text();\r\n    return jsonc.parse(text);\r\n  } catch(e){\r\n    console.error(`Error fetching or parsing manifest from ${url}`, e);\r\n    return {};\r\n  }\r\n}\r\n\r\nconst fetchPetFiles = async (petFiles: PetManifestEntry[]) => {\r\n  let promises = [] as Promise<RawPetJSON>[];\r\n  petFiles.forEach(pF => promises.push(getPetPromise(pF)));\r\n  const result = await Promise.all(promises);\r\n  return result\r\n}\r\n\r\nconst getPetPromise = (petFile: PetManifestEntry): Promise<RawPetJSON> => {\r\n  return new Promise(resolve => resolve(fetchPetFile(petFile)));\r\n}\r\n\r\nconst fetchPetFile = async (petManifestEntry: PetManifestEntry) => {\r\n  const url = petManifestEntry.baseUrl + '/data.jsonc';\r\n  try{\r\n    const response = await fetch(url, { mode: 'cors'});\r\n    if(!response.ok){\r\n      throw `bad response`;\r\n    }\r\n    const petJson = jsonc.parse(await response.text());\r\n    petJson.baseUrl = petManifestEntry.baseUrl;\r\n    \r\n    return petJson;\r\n  } catch(e){\r\n    console.error(`Error fetching or parsing pet manifest from ${url}`, e);\r\n    return {};\r\n  }\r\n}\r\n\r\nconst finishUp = (parsedPets: RawPetJSON[], dispatch: any, savedData: LocalStorageState) => {\r\n  const now = new Date().getTime();\r\n  console.log('>>> FINISH UP')\r\n  console.log(`JSON definitions parsed successfully`, parsedPets);\r\n  console.log(`LocalStorage was read successfully`, savedData);\r\n  let activeId = '';\r\n  \r\n  if(savedData.config.activePet){\r\n    activeId = savedData.config.activePet;\r\n  }\r\n\r\n\r\n  parsedPets.forEach((petDef: RawPetJSON) => {\r\n    const savedStatus = savedData?.pets.find(p => p.id === petDef.id) || null;\r\n    if(!activeId && savedStatus && savedData.config.activePet === savedStatus.id){\r\n      activeId = savedStatus.id;\r\n    }\r\n    dispatch(createPet({\r\n      isActive: (activeId === savedStatus?.id),\r\n      petDefinition: petDef,\r\n      initialState: savedStatus\r\n    }));\r\n  });\r\n\r\n  if(activeId){\r\n    dispatch(setActiveId(activeId));\r\n  }else{\r\n    dispatch(setActiveIdx(0));\r\n  }\r\n\r\n  savedData.interactions.filter(interaction => interaction.endAt > now).forEach(interaction => {\r\n    dispatch((thunkDispatch:Dispatch) => {\r\n      thunkDispatch(restoreInteractionFromSave(interaction))\r\n      window.setTimeout(() => {\r\n        thunkDispatch(removeInteractionEvent(interaction.id))\r\n      }, interaction.endAt - now);\r\n    });\r\n  });\r\n\r\n  // dispatch(pingStore({ time: now, doSave: true }));\r\n}\r\n\r\nexport const Loader = () => {\r\n  const dispatch = useDispatch();\r\n  const [ loaded, setLoaded ] = useState(false);\r\n  const [ savedData, ] = useLocalStorage('browserpet', DEFAULT_LOCALSTORAGE_STATE);\r\n\r\n  useEffect(() => {\r\n    if(!loaded){\r\n      setLoaded(true);\r\n      fetchAllData(`assets/pet-manifest.jsonc`, dispatch, savedData);\r\n    }\r\n  }, [ loaded, savedData, setLoaded, dispatch ]);\r\n\r\n  return (null);\r\n}\r\n","import { useEffect, useLayoutEffect, useRef } from 'react'\r\n\r\nfunction useInterval(callback: () => void, delay: number | null) {\r\n  const savedCallback = useRef(callback)\r\n\r\n  // Remember the latest callback if it changes.\r\n  useLayoutEffect(() => {\r\n    savedCallback.current = callback\r\n  }, [callback])\r\n\r\n  // Set up the interval.\r\n  useEffect(() => {\r\n    // Don't schedule if no delay is specified.\r\n    // Note: 0 is a valid value for delay.\r\n    if (!delay && delay !== 0) {\r\n      return\r\n    }\r\n\r\n    const id = setInterval(() => savedCallback.current(), delay)\r\n\r\n    return () => clearInterval(id)\r\n  }, [delay])\r\n}\r\n\r\nexport default useInterval\r\n","import { useState } from 'react';\r\n\r\nimport useInterval from '../../util/hooks/useInterval';\r\nimport { pingStore } from '../../services/petstore';\r\nimport { useDispatch } from 'react-redux';\r\n\r\nconst PING_RATE = 2000;\r\n// const SAVE_RATE = 2000;\r\nconst SAVE_RATE = PING_RATE * 2;\r\n\r\nexport const Pinger = () => {\r\n  const [pinger, setPinger] = useState(0);\r\n  const dispatch = useDispatch();\r\n\r\n  useInterval(() => {\r\n    const t = new Date().getTime();\r\n    setPinger(pinger + 1);\r\n    if((((pinger + 1) * PING_RATE) % SAVE_RATE) === 0){\r\n      console.log(`----SAVE: ${pinger + 1}------- `);\r\n      dispatch(pingStore({ time: t, doSave: true}));\r\n    }else{\r\n      console.log(`----PING: ${pinger + 1}------- `);\r\n      dispatch(pingStore({ time: t, doSave: false}));\r\n    }\r\n  }, PING_RATE);\r\n\r\n  return null;\r\n}\r\n","import { useEffect } from 'react';\r\n\r\nimport useLocalStorage from '../../util/hooks/useLocalStorage';\r\nimport { selectNewSavePayload, setCachedPayload } from '../../services/petstore';\r\nimport { DEFAULT_LOCALSTORAGE_STATE } from '../../services/store';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nlet lastSaved = 0;\r\n\r\nexport const Saver = () => {\r\n  const [ , setLocalStorage ] = useLocalStorage('browserpet', DEFAULT_LOCALSTORAGE_STATE);\r\n  const savePayload = useSelector(selectNewSavePayload);\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    // this check avoids trying to save the initialState on first load, maybe there's a better way around this.\r\n    if(savePayload && !!savePayload.config.activePet){\r\n      console.log('> setLocalStorage', savePayload.config.lastSaved);\r\n      setLocalStorage(() => savePayload);\r\n      if(lastSaved !== savePayload.config.lastSaved){\r\n        lastSaved = savePayload.config.lastSaved;\r\n        dispatch(setCachedPayload(savePayload));\r\n      }\r\n    }\r\n  }, [ savePayload, dispatch, setLocalStorage ])\r\n\r\n  return null;\r\n}\r\n","import React from 'react';\r\nimport { Loader } from './loader';\r\nimport { Pinger } from './pinger';\r\nimport { Saver } from './saver';\r\n\r\n\r\nconst Helper = () => {\r\n  return (\r\n    <>\r\n      <Saver />\r\n      <Loader />\r\n      <Pinger />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Helper;","import React from 'react';\r\nimport { getColor } from '../../themes/';\r\n\r\nimport styled from 'styled-components';\r\nimport { getShade } from '../../themes';\r\nimport { round } from '../../util/tools';\r\n\r\nconst ScContainer = styled.div`\r\n  display:inline-block;\r\n  width:calc(50% - 1rem);\r\n  margin-right:1rem;\r\n`;\r\n\r\nconst ScLabel = styled.h4`\r\n  font-size: 1rem;\r\n`;\r\n\r\nconst ScBar = styled.div`\r\n  position:relative;\r\n  border:.5rem solid ${getColor('white')};\r\n  border-radius: 1rem;\r\n  overflow:hidden;\r\n  padding:.25rem .5rem;\r\n  text-align:center;\r\n  background-color: ${getColor('white')};\r\n\r\n  box-shadow: 0px -2px 4px ${getShade('white', -40)};\r\n`;\r\n\r\nconst ScBarValue = styled.span`\r\n  position: relative;\r\n  font-size: 1.5rem;\r\n  font-weight: bold;\r\n  z-index:1;\r\n`;\r\n\r\nconst ScBarFill = styled.div`\r\n  position:absolute;\r\n  top:0;\r\n  left:0;\r\n  height:100%; \r\n  transition: width .3s ease-in-out, background-color .5s ease-in-out;\r\n  background-color: ${getColor('blue')};\r\n`;\r\n\r\ntype StatBarProps = {\r\n  label: string,\r\n  max: number,\r\n  value: number,\r\n  hideStats?: boolean\r\n};\r\n\r\nexport const StatBar = ({label, max, value, hideStats = false}: StatBarProps) => {\r\n  const percent = Math.round((value / max) * 1000) / 10;\r\n\r\n  return (\r\n    <ScContainer>\r\n      <ScLabel>{label.toLocaleUpperCase()}</ScLabel>\r\n      <ScBar>\r\n        <ScBarValue>{!hideStats && `${round(value)} / ${max} (${percent}%)`}</ScBarValue>\r\n        <ScBarFill style={{width:`${percent}%`}} />\r\n      </ScBar>\r\n    </ScContainer>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport { StatBar } from './stat-bar';\r\nimport { selectRenderedDeltaStats } from '../../services/petstore';\r\nimport { useSelector } from 'react-redux';\r\n\r\nconst ScStats = styled.div`\r\n  width:100%;\r\n`;\r\n\r\nexport const StatGroup = () => {\r\n  const activeStats = useSelector(selectRenderedDeltaStats);\r\n\r\n  return (\r\n    <ScStats>\r\n      {activeStats.map((s, idx) => (\r\n        <StatBar \r\n          key={idx}\r\n          label={s.label}\r\n          max={s.max}\r\n          value={s.value}\r\n        />\r\n      ))}\r\n    </ScStats>\r\n  )\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport styled from 'styled-components';\r\nimport { getColor } from '../../../themes';\r\n\r\ntype ScProgressBarProps = {\r\n  startWidth: string\r\n}\r\n\r\nconst ScWrapper = styled.div`\r\n  position:absolute;\r\n  left:0;\r\n  bottom:0;\r\n  height:100%;\r\n  width:100%;\r\n`;\r\n\r\nconst ScProgressBg = styled.div`\r\n  background-color:${getColor('white')};\r\n  position:absolute;\r\n  left:0;\r\n  top:0;\r\n  right:0;\r\n  bottom:0;\r\n`;\r\n\r\nconst ScProgressBar = styled.div<ScProgressBarProps>`\r\n  background-color:${getColor('red')};\r\n  position:absolute;\r\n  height:100%;\r\n  left:0;\r\n  width: ${p => p.startWidth};\r\n\r\n  &.full{\r\n    width:100% !important;\r\n    background-color: ${getColor('blue')};\r\n  }\r\n  z-index:1;\r\n`\r\n\r\ntype ProgressBarProps = {\r\n  startProgress: number,\r\n  duration: number\r\n}\r\n\r\nexport const ProgressBar = ({startProgress, duration}: ProgressBarProps) => {\r\n  const [ loaded, setLoaded ] = useState(false);\r\n  useEffect(() => {\r\n    if(!loaded) {\r\n      window.setTimeout(() => setLoaded(true), 1);\r\n    };\r\n  }, [ loaded, setLoaded ]);\r\n\r\n  return (\r\n    <ScWrapper>\r\n      <ScProgressBar \r\n        startWidth={`${startProgress * 100}%`} \r\n        className={loaded ? 'full' : ''} \r\n        style={{ transition: `all ${duration}s linear` }} />\r\n      <ScProgressBg />\r\n    </ScWrapper>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport { getColor } from '../../../themes';\r\nimport { ActiveInteractionStatus, PetInteractionDefinition } from '../../../types';\r\nimport { ProgressBar } from './progress-bar';\r\n\r\n\r\nconst ScInteraction = styled.li`\r\n  text-align:center;\r\n`;\r\n\r\nconst ScButton = styled.div`\r\n  font-weight:bold;\r\n  font-size: 2rem;\r\n\r\n  padding:1rem 1.5rem;\r\n\r\n  position:relative;\r\n  overflow: hidden;\r\n  cursor:pointer;\r\n\r\n  \r\n  background-color: ${getColor('blue')};\r\n  color: ${getColor('white')};\r\n  border: .5rem solid ${getColor('white')};\r\n  border-radius: 1rem;\r\n`;\r\n\r\nconst ScCooldownButton = styled(ScButton)`\r\n  background-color: ${getColor('red')};\r\n  border-color: ${getColor('white')};\r\n  color: ${getColor('white')};\r\n\r\n  cursor:not-allowed;\r\n`;\r\n\r\nconst ScLabel = styled.p`\r\n  display:block;\r\n  position:relative;\r\n  z-index:2;\r\n  font-size: 2rem;\r\n`\r\n\r\ntype InteractionButtonProps = {\r\n  activeStatus?: ActiveInteractionStatus,\r\n  interaction: PetInteractionDefinition,\r\n  onClickHandler?: Function\r\n}\r\n\r\nexport const InteractionButton = ({activeStatus, interaction, onClickHandler}: InteractionButtonProps) => {\r\n  if(activeStatus){\r\n    const total = activeStatus.endAt - activeStatus.startAt; \r\n    const progress = (total - (activeStatus.endAt - new Date().getTime())) / total;\r\n    const timeLeft = (activeStatus.endAt - new Date().getTime()) / 1000;\r\n\r\n    // console.log(`${interaction.id} is %${progress * 100} complete with ${timeLeft} left.`)\r\n    // console.log(`of ${total / 1000} seconds`)\r\n    return(\r\n      <ScInteraction >\r\n        <ScCooldownButton>\r\n          <ScLabel>{interaction.label}</ScLabel>\r\n          <ProgressBar startProgress={progress} duration={timeLeft} />\r\n        </ScCooldownButton>\r\n      </ScInteraction>\r\n    );\r\n  }else{\r\n    return(\r\n      <ScInteraction onClick={() => onClickHandler && onClickHandler()} >\r\n        <ScButton>\r\n          <ScLabel>{`${interaction.label}`}</ScLabel>\r\n        </ScButton>\r\n      </ScInteraction>\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\r\nimport { Dispatch } from '@reduxjs/toolkit';\r\n\r\nimport { selectActiveInteractionDefinitions, addNewInteractionEvent, selectActiveInteractionStatus, removeInteractionEvent } from '../../../services/petstore';\r\nimport { PetInteractionDefinition } from '../../../types';\r\nimport { InteractionButton } from './interaction-button';\r\n\r\nconst ScInteractions = styled.ul`\r\n  border-bottom: .25rem dashed black;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n\r\n  >li{\r\n    margin:.5rem;\r\n    margin-left: .25rem;\r\n    &:first-child{\r\n      margin-left: .5rem;\r\n    }\r\n    flex: 1;\r\n    list-style:none;\r\n  }\r\n`;\r\n\r\nexport const Interactions = () => {\r\n  const interactionDefs = useSelector(selectActiveInteractionDefinitions, shallowEqual);\r\n  const interactionStatus = useSelector(selectActiveInteractionStatus, shallowEqual);\r\n\r\n  // thunk madness, cause I don't know how else to do this.\r\n  const dispatch = useDispatch();\r\n  const addTemporaryInteraction = (interaction: PetInteractionDefinition) => {\r\n    const now = new Date().getTime();\r\n    dispatch((thunkDispatch: Dispatch) => {\r\n      thunkDispatch(addNewInteractionEvent({ \r\n        interaction: interaction, \r\n        time: now \r\n      }));\r\n      if(interaction.cooldown){\r\n        window.setTimeout(() => {\r\n          thunkDispatch(removeInteractionEvent(interaction.id))\r\n        }, interaction.cooldown);\r\n      }\r\n    });\r\n  }\r\n\r\n  return (\r\n    <ScInteractions>\r\n      {interactionDefs.map((interaction, i) => (\r\n        <InteractionButton\r\n          key={interaction.id}\r\n          activeStatus={interactionStatus.find(iS => iS.id === interaction.id)}\r\n          interaction={interaction}\r\n          onClickHandler={() => addTemporaryInteraction(interaction)} />\r\n      ))}\r\n    </ScInteractions>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport { getColor } from '../../themes/';\r\n\r\nimport styled from 'styled-components';\r\nimport { StatGroup } from './stat-group';\r\nimport { selectActiveInfo } from '../../services/petstore';\r\nimport { useSelector } from 'react-redux';\r\nimport { Interactions } from './interactions';\r\n\r\nconst ScContainer = styled.div`\r\n  position:absolute;\r\n  left:0;\r\n  right:0;\r\n  top:-.5rem;\r\n  bottom:0;\r\n\r\n  background-color:${getColor('green')};\r\n  border:.5rem solid ${getColor('white')};\r\n  border-radius:2rem;\r\n  overflow:hidden;\r\n\r\n  box-shadow: .25rem .25rem .55rem .45rem ${getColor('grey')};\r\n`\r\n\r\nconst ScPetInfo = styled.div`\r\n  width:100%;\r\n  height:16rem;\r\n\r\n  font-size: 1.5rem;\r\n  line-height: 1.5rem;\r\n  padding: 0.25rem .5rem .5rem .5rem;\r\n  font-weight:500;\r\n  padding:2rem;\r\n  \r\n  color: black;\r\n  \r\n\r\n  overflow-y:auto;\r\n\r\n  hr{\r\n    border-color:${getColor('blue')};\r\n    border-style:dashed;\r\n    margin-top:.5rem;\r\n    margin-bottom:.5rem;\r\n\r\n    margin-left:10%;\r\n    width:80%;\r\n  }\r\n`\r\n\r\nconst ScBio = styled.div`\r\n  width:100%;\r\n`;\r\n\r\nconst ScBioName = styled.h4`\r\n  margin-top:1rem;\r\n  margin-bottom:.5rem;\r\n`;\r\n\r\nconst ScBioInfo = styled.p`\r\n  margin-top:1rem;\r\n  padding-left:1rem;\r\n`;\r\n\r\nconst ScInteractions = styled.div`\r\n  min-height:5rem;\r\n  width:100%;\r\n`;\r\n\r\nexport const Footer = () => {\r\n  const petInfo = useSelector(selectActiveInfo);\r\n  if(!petInfo) return null;\r\n\r\n  return (\r\n    <ScContainer>\r\n      <ScInteractions>\r\n        <Interactions />\r\n      </ScInteractions>\r\n      <ScPetInfo>\r\n        <StatGroup />\r\n        <hr/>\r\n        <ScBio>\r\n          <ScBioName>{'Description'}</ScBioName>\r\n          <ScBioInfo>{petInfo.bio}</ScBioInfo>\r\n        </ScBio>\r\n      </ScPetInfo>\r\n    </ScContainer>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport styled, { css } from 'styled-components';\r\n\r\nimport { selectDetailedActiveDeltaStatuses } from '../../services/petstore';\r\nimport { shallowEqual, useSelector } from 'react-redux';\r\nimport { getColor, mixinColorBubble, tColor } from '../../themes';\r\nimport { AlertType } from '../../types';\r\n\r\nconst ScContainer = styled.div`\r\n  color:${getColor('black')};\r\n  position:absolute;\r\n  right:0;\r\n  bottom:1rem;\r\n  z-index:1;\r\n`;\r\nconst ScStatuses = styled.ul`\r\n  max-width: 14rem;\r\n  text-align: right;\r\n`;\r\n\r\ninterface ScStatusProps {\r\n  bubbleColors: tColor[]\r\n}\r\nconst ScStatus = styled.li<ScStatusProps>`\r\n  /* display:inline-block; */\r\n  white-space:nowrap;\r\n  text-align:right;\r\n  z-index:1;\r\n  \r\n  list-style:none;\r\n  color:black;\r\n  margin-top: -.5rem;\r\n  margin-right: -1rem;\r\n  font-weight:bold;\r\n  font-size: 2rem;\r\n\r\n  /* border-top-left-radius: 0; */\r\n  border-bottom-right-radius: 0;\r\n  padding:.5rem 1rem;\r\n\r\n  position:absolute;\r\n  bottom:0;\r\n  right:0;\r\n\r\n  /* transition: transform .2s ease-in-out, bottom .2s ease-out; */\r\n  -webkit-transition: all 0.2s cubic-bezier(.72,1.79,.4,.8);\r\n  transition: all 0.2s cubic-bezier(.72,1.79,.4,.8);\r\n  ${props => mixinColorBubble(props.bubbleColors[0], props.bubbleColors[1])}\r\n`;\r\n\r\nconst getBubbleColors = (alertType?: AlertType) => {\r\n  switch(alertType){\r\n    case 'alert': return [ 'red', 'yellow' ];\r\n    case 'warning': return [ 'yellow', 'red' ];\r\n    case 'reward': return [ 'green', 'white' ];\r\n    default: return [ 'white', 'red' ];\r\n  }\r\n}\r\n\r\nconst getRotation = () => {\r\n  return -5 + Math.random() * 5;\r\n}\r\nconst getBottom = (index:number) => {\r\n  return index * 35;\r\n}\r\n\r\nexport const Statuses = () => {\r\n  const activeDeltaStatuses = useSelector(selectDetailedActiveDeltaStatuses, shallowEqual);\r\n\r\n  return (\r\n    <ScContainer>\r\n      <ScStatuses>\r\n        {activeDeltaStatuses.map((dS,i) => (\r\n          <ScStatus \r\n            key={dS.id} \r\n            id={dS.id}\r\n            bubbleColors={getBubbleColors(dS.alertType) as tColor[]} \r\n            style={{ bottom: getBottom(i), transform: `rotate(${getRotation()}deg)`}}>\r\n              {dS.label}\r\n          </ScStatus>\r\n        ))}\r\n      </ScStatuses>\r\n    </ScContainer>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport styled, { css } from 'styled-components';\r\n\r\nimport { getColor } from '../../themes/';\r\nimport { selectActiveBehavior, selectActiveBg } from '../../services/petstore';\r\nimport { shallowEqual, useSelector } from 'react-redux';\r\nimport { Statuses } from './statuses';\r\n\r\ntype ScContainerProps = {\r\n  bgImageUrl?: string;\r\n}\r\n\r\nconst ScContainer = styled.div<ScContainerProps>`\r\n  position:absolute;\r\n  left:0;\r\n  right:0;\r\n  top:-2rem;\r\n  padding-top:2rem;\r\n  bottom:-2rem;\r\n  padding-bottom:2rem;\r\n  background-color: ${getColor('blue')};\r\n  border:.5rem solid ${getColor('white')};\r\n\r\n  ${p => p.bgImageUrl && css`\r\n    background-size:cover;\r\n    background-position: center;\r\n    background-image:url(${p.bgImageUrl});\r\n  `}\r\n`;\r\n\r\nconst ScPetImage = styled.div`\r\n  background-size:contain;\r\n  background-repeat:no-repeat;\r\n  background-position:center;\r\n  width:100%;\r\n  height:100%;\r\n  text-align:center;\r\n\r\n  position:absolute;\r\n  bottom:0;\r\n  left:0;\r\n`;\r\n\r\nconst ScBehavior = styled.p`\r\n  font-size:2rem;\r\n  color:${getColor('white')};\r\n  opacity: .5;\r\n\r\n  position:absolute;\r\n  top:1rem;\r\n  right:1rem;\r\n`\r\n\r\nexport const PetContainer = () => {\r\n  const activeBehavior = useSelector(selectActiveBehavior, shallowEqual);\r\n  const bgImageUrl = useSelector(selectActiveBg, shallowEqual);\r\n\r\n  return (\r\n    <ScContainer bgImageUrl={bgImageUrl}>\r\n      { activeBehavior && (\r\n        <>\r\n          <ScBehavior>{`behavior: ${activeBehavior.id}`}</ScBehavior>\r\n          <Statuses />\r\n          <ScPetImage style={{ \r\n            backgroundImage: `url(${activeBehavior.imageUrl})`, \r\n            backgroundPosition: `${activeBehavior.position}`,\r\n            left: `${activeBehavior.offsetX}px`,\r\n            bottom: `${activeBehavior.offsetY}px`\r\n          }}/>\r\n        </>\r\n      ) }\r\n    </ScContainer>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport styled from 'styled-components';\r\nimport { selectActiveInfo } from '../../services/petstore';\r\nimport { getColor } from '../../themes';\r\n\r\nconst ScContainer = styled.div`\r\n  width:100%;\r\n  height:100%;\r\n  \r\n  color:${getColor('white')};\r\n  background-color: ${getColor('blue')};\r\n  border:.5rem solid ${getColor('white')};\r\n  border-radius: 1rem;\r\n  position:relative;\r\n  padding:0rem 1rem;\r\n\r\n  display:flex;\r\n  box-shadow: .25rem .25rem .25rem .05rem ${getColor('grey')};\r\n\r\n  >div{\r\n    display:inline-block;\r\n    vertical-align:middle;\r\n    height:100%;\r\n  }\r\n`;\r\n\r\nconst ScLabel = styled.div`\r\n  flex:1;\r\n\r\n  >p{\r\n    font-style:italic;\r\n  }\r\n\r\n  >h4{\r\n    margin-top:-.5rem;\r\n    margin-bottom: -.5rem;\r\n  }\r\n`\r\n\r\nconst ScPetLevel = styled.div`\r\n  text-align:right;\r\n  color: ${getColor('white')};\r\n  \r\n  >h4{\r\n    margin:0;\r\n    line-height: 5rem;\r\n  }\r\n`;\r\n\r\nconst ScPetName = styled.h4`\r\n  text-align:left;\r\n  display:inline-block;\r\n  flex:1;\r\n`;\r\n\r\n\r\nconst ScBornOn = styled.p`\r\n  \r\n`\r\n\r\nconst getDateLabel = (epoch?: number) => {\r\n  if(!epoch){\r\n    return null;\r\n  }else{\r\n    const date = new Date(epoch);    \r\n    return date.toLocaleString(\"en-us\");\r\n  }\r\n};\r\n\r\nexport const HeaderBottom = () => {\r\n  const petInfo = useSelector(selectActiveInfo);\r\n\r\n  return (\r\n    <ScContainer>\r\n      {petInfo && (\r\n        <>\r\n          <ScLabel>\r\n            <ScPetName>{petInfo.name}</ScPetName>\r\n            <ScBornOn>{`born on: ${getDateLabel(petInfo.bornOn)}`}</ScBornOn>\r\n          </ScLabel>\r\n          <ScPetLevel>\r\n            <h4>{`Level: ${petInfo.level}`}</h4>\r\n          </ScPetLevel>\r\n        </>\r\n      )}\r\n    </ScContainer>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport { getColor, getShade } from '../../themes/';\r\n\r\nimport styled, { css } from 'styled-components';\r\n\r\nimport { \r\n  selectPetList, \r\n  setActiveIdx \r\n} from '../../services/petstore';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nconst ScTabs = styled.ul`\r\n  position:absolute;\r\n  width:100%; \r\n  padding-left:1rem;\r\n  left:0;\r\n  bottom:-.5rem;\r\n`;\r\n\r\ntype ScTabProps = {\r\n  isActive?: boolean\r\n};\r\n\r\nconst ScTab = styled.li<ScTabProps>`\r\n  list-style:none;\r\n  margin:none;\r\n  \r\n  display:inline-block;\r\n  vertical-align:bottom;\r\n  background-color:white;\r\n  color: black;\r\n\r\n  font-size:2rem;\r\n  line-height:2rem;\r\n  font-weight:bold;\r\n  padding: .25rem 1rem;\r\n  padding-bottom: 0rem;\r\n  margin-right:.25rem;\r\n  margin-bottom: -.25rem;\r\n\r\n  border:.5rem solid ${getColor('white')};\r\n  border-radius:1rem 1rem 0 0;\r\n\r\n  background-color:${getColor('blue')};\r\n  border-bottom-color: ${getColor('white')};\r\n  color:${getColor('black')};\r\n  transition: padding-bottom .1s ease-in-out, background-color .1s ease-in-out;\r\n\r\n  &:hover{\r\n    background-color:${getShade('blue', 20)};\r\n  }\r\n  \r\n  ${props => props.isActive && css`\r\n    background-color:${getColor('green')};\r\n    padding-bottom: .5rem;\r\n    padding-top: .5rem;\r\n    transition: padding .2s ease-out, background-color .2s ease-out;\r\n\r\n    &:hover{\r\n      background-color:${getShade('green', 40)};\r\n    }\r\n  `};\r\n\r\n  cursor:pointer;\r\n`\r\n\r\nexport const PetTabs = () => {\r\n  const petList = useSelector(selectPetList);\r\n  const dispatch = useDispatch();\r\n\r\n  return (\r\n    <ScTabs>\r\n      {petList.map((p, idx) => (\r\n        <ScTab \r\n          key={idx} \r\n          onClick={() => dispatch(setActiveIdx(idx))} \r\n          isActive={p.isActive}\r\n        >\r\n          {idx + 1}\r\n        </ScTab>\r\n      ))}\r\n    </ScTabs>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useHistory } from 'react-router-dom';\r\nimport styled from 'styled-components';\r\nimport { clearSave } from '../../services/petstore';\r\n\r\nimport { getColor, getShade } from '../../themes/';\r\nimport { PetTabs } from './pet-tabs';\r\n\r\nconst ScHelpButton = styled.div`\r\n  position:absolute;\r\n  right:0rem;\r\n  bottom:-.5rem;\r\n  width:3rem;\r\n  height:3rem;\r\n\r\n  border-radius:2rem 2rem 0 0;\r\n  background-color: ${getColor('red')};\r\n  color: ${getColor('white')};\r\n\r\n  font-size:1.5rem;\r\n  font-weight:bold;\r\n  text-align:center;\r\n  line-height:2rem;\r\n  text-shadow:1px 1px 1px ${getColor('black')};\r\n  border:.5rem solid ${getColor('white')};\r\n\r\n  cursor:pointer;\r\n  &:hover{\r\n    background-color: ${getShade('red', 40)};\r\n  }\r\n`;\r\n\r\nconst ScLogo = styled.h1`\r\n  font-size:2rem;\r\n  text-align:right;\r\n  margin-right:4rem;\r\n  margin-bottom:-.5rem;\r\n`;\r\n\r\nconst ScContainer = styled.div`\r\n  display:flex;\r\n  flex-direction:row;\r\n\r\n  >div{\r\n    flex:1;\r\n    position:relative;\r\n  }\r\n`\r\n\r\nexport const HeaderTop = () => {\r\n  // let { push } = useHistory();\r\n  const dispatch = useDispatch();\r\n\r\n  return (\r\n    <ScContainer>\r\n      <div>\r\n        <PetTabs />\r\n      </div>\r\n      <div>\r\n        <ScLogo>{'Browser Pet'}</ScLogo>\r\n        {/* <ScHelpButton onClick={() => {push('/about')}}> */}\r\n        <ScHelpButton onClick={() => dispatch(clearSave())}>\r\n          {'X'}\r\n        </ScHelpButton>\r\n      </div>\r\n    </ScContainer>\r\n  )\r\n}","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport { HeaderBottom } from './header-bottom';\r\n\r\nimport { HeaderTop }  from './header-top';\r\nconst ScHeader = styled.header`\r\n  position: relative;\r\n  height:8rem;\r\n  z-index:1;\r\n\r\n  display:flex;\r\n  flex-direction:column;\r\n`;\r\n\r\nconst ScTop = styled.div`\r\n  flex: 0 0 2rem;\r\n`;\r\n\r\nconst ScBottom = styled.div`\r\n  flex: 1;\r\n`;\r\n\r\nexport const Header = () => {\r\n  return (\r\n    <ScHeader>\r\n      <ScTop>\r\n        <HeaderTop />\r\n      </ScTop>\r\n      <ScBottom>\r\n        <HeaderBottom />\r\n      </ScBottom>\r\n    </ScHeader>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nimport { getColor } from '../themes/';\r\n\r\nimport Helpers from './helpers';\r\nimport { Footer } from './footer';\r\nimport { PetContainer } from './pet-container';\r\nimport { Header } from './header';\r\n\r\nconst ScContainer = styled.div`\r\n  padding:1rem;\r\n  color: ${getColor('blue')};\r\n  position:absolute;\r\n  left:0;\r\n  right:0;\r\n  top:0;\r\n  bottom:0;\r\n  min-width:30rem;\r\n  min-height:55rem;\r\n\r\n  display:grid;\r\n  grid-template-columns: auto;\r\n  grid-template-rows: 10rem auto 20rem;\r\n  grid-template-areas:\r\n    \"header\"\r\n    \"body\"\r\n    \"footer\";\r\n\r\n  >div{\r\n    position:relative;\r\n  }\r\n`;\r\n\r\nconst ScHeader = styled.div`\r\n  grid-area: header;\r\n`;\r\n\r\nconst ScBody = styled.div`\r\n  grid-area: body;\r\n`;\r\n\r\n\r\nconst ScFooter = styled.div`\r\n  grid-area: footer;\r\n`;\r\n\r\n\r\nexport const Main = () => {\r\n  return (\r\n    <ScContainer>\r\n      <Helpers />\r\n      <ScHeader>\r\n        <Header />\r\n      </ScHeader>\r\n      <ScBody>\r\n        <PetContainer />\r\n      </ScBody>\r\n      <ScFooter>\r\n        <Footer />\r\n      </ScFooter>\r\n    </ScContainer>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport { Route, Switch } from 'react-router-dom';\r\nimport { About } from './about';\r\nimport { Main } from './main';\r\n\r\nexport const App = () => {\r\n  return (\r\n    <Switch>\r\n      <Route path=\"/about\">\r\n        <About />\r\n      </Route>\r\n      <Route path=\"/\">\r\n        <Main />\r\n      </Route>\r\n    </Switch>\r\n  )\r\n};\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\n\r\nimport { App } from './containers/app';\r\nimport { store } from './services/store';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport { BrowserRouter } from 'react-router-dom';\r\nimport './themes/fonts.css';\r\nimport GlobalStyle from './themes/';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <BrowserRouter>\r\n        <App />\r\n        <GlobalStyle />\r\n      </BrowserRouter>\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","import { PetStatDefinition, DeltaStat, SavedPetState, CachedPetStat } from '../types';\r\n\r\n// general\r\nexport const round = (number:number, pad?:number) => {\r\n  if(!pad) return Math.round(number);\r\n  \r\n  const rounder = Math.pow(10, pad);\r\n  return Math.round(number * rounder) / rounder;\r\n};\r\n\r\nexport const clamp = (val:number, min:number, max:number) => {\r\n  return Math.min(Math.max(val, min), max);\r\n};\r\n\r\nexport const randBetween = (range:number[]) => {\r\n  return range[0] + (Math.random() * (range[1] - range[0]));\r\n};\r\n\r\nexport const getStatValue = (s: PetStatDefinition, cachedPetStats: CachedPetStat[], timeDiff: number, forceCurrent?: boolean) => {\r\n  let curValue = cachedPetStats.find(cS => cS.id === s.id)?.value;\r\n  if(curValue === undefined){\r\n    curValue = s.value;\r\n  }\r\n\r\n  if(forceCurrent) return curValue; // from invalid time supplied, dont calculate\r\n  return Math.round((clamp(curValue + (s.perSecond * timeDiff), 0, s.max)) * 100) / 100\r\n}\r\n\r\nexport const getRenderedDeltaStats = (stats: PetStatDefinition[], cachedPetStats: CachedPetStat[], oldSaveTime: number, newSaveTime: number) =>{\r\n  const timeDiff = (newSaveTime - oldSaveTime) / 1000;\r\n  /*\r\n    TODO, this could get removed simplified after resolving:\r\n    - redundant call on save\r\n    - negative time on change pet between saves\r\n  */\r\n\r\n  if(timeDiff <= 0){\r\n    return stats.map(s => {\r\n      return {\r\n        id: s.id,\r\n        value: getStatValue(s, cachedPetStats, timeDiff, true),\r\n        max: s.max,\r\n        label: s.label\r\n      }\r\n    });\r\n  }\r\n\r\n  return stats.map(s => {\r\n    return {\r\n      id: s.id,\r\n      value: getStatValue(s, cachedPetStats, timeDiff),\r\n      max: s.max,\r\n      label: s.label\r\n    }\r\n  });\r\n};\r\n\r\nexport const getCachedDeltaStats = (stats: PetStatDefinition[], cachedPetStats: CachedPetStat[], oldSaveTime: number, newSaveTime: number) =>{\r\n  const timeDiff = (newSaveTime && oldSaveTime) ? (newSaveTime - oldSaveTime) / 1000 : 0;\r\n  return stats.map(s => {\r\n    return {\r\n      id: s.id,\r\n      value: getStatValue(s, cachedPetStats, timeDiff)\r\n    } as DeltaStat;\r\n  });\r\n};","import { ConditionOperator, RawWhenThen, WhenNumber, WhenThenNumberGroup, WhenThenStringGroup } from '../types';\r\n\r\n\r\nexport const evaluateWhenThenNumberGroup = (whenThenNumberGroup: WhenThenNumberGroup, referenceValue: number, maxValue:number) => {\r\n  if(whenThenNumberGroup.when.find(w => !evaluateWhenNumber(w, referenceValue, maxValue))){\r\n    // something in the required group was not found\r\n    return null;\r\n  }\r\n  return whenThenNumberGroup.then;\r\n};\r\n\r\nexport const evaluateWhenThenStringGroup = (whenThenStringGroup: WhenThenStringGroup, stringCriteria: string[]) => {\r\n  // remember, an empty when skips this and just returns the result\r\n  if (whenThenStringGroup.when.find(w => stringCriteria.indexOf(w) === -1)){\r\n    // something in the required group was not found\r\n    return null;\r\n  };\r\n\r\n  return whenThenStringGroup.then;\r\n};\r\n\r\nexport const parseRawWhenThenGroup = (rawWhenThenGroup: RawWhenThen[], type: 'stats' | 'statuses') => {\r\n  if(type === 'statuses'){\r\n    return rawWhenThenGroup.map(rwt => {\r\n      // json should support string or array, make this better\r\n      const whens = typeof rwt.when === 'string' ? [ rwt.when ] : rwt.when;\r\n      return {\r\n        when: whens,\r\n        then: rwt.then\r\n      } as WhenThenStringGroup;\r\n    }) as WhenThenStringGroup[];\r\n  } else if (type === 'stats'){\r\n    if(!rawWhenThenGroup) return [] as WhenThenNumberGroup[];\r\n    return rawWhenThenGroup.map(rwt => {\r\n      // json should support string or array, make this better\r\n      const whens = typeof rwt.when === 'string' ? [ rwt.when ] : rwt.when;\r\n      return {\r\n        when: whens.map(w => parseExpressionString(w)).filter(w => w !== null),\r\n        then: rwt.then\r\n      } as WhenThenNumberGroup;\r\n    }) as WhenThenNumberGroup[];\r\n  }\r\n  return [] as WhenThenNumberGroup[];\r\n};\r\n\r\n/*\r\n  //- convert <=_20% into:\r\n  {\r\n    condition: '<=',\r\n    criteria: '20',\r\n    isPercent: true\r\n  }\r\n*/\r\nexport const EXPRESSION_MAP = {\r\n  '=': (v:number, c:number) => (v === c),\r\n  '<': (v:number, c:number) => (v < c),\r\n  '<=': (v:number, c:number) => (v <= c),\r\n  '>': (v:number, c:number) => (v > c),\r\n  '>=': (v:number, c:number) => (v >= c)\r\n};\r\n\r\nexport const parseExpressionString = (expressionString: string) => {\r\n  try{\r\n    const valueTokens = expressionString.split('_');\r\n    const condition = valueTokens[0] as ConditionOperator;\r\n    const valueCriteria = valueTokens[1];\r\n    const percentageSplit = valueCriteria.split('%');\r\n\r\n    if(!EXPRESSION_MAP[condition]){\r\n      console.error(`parseExpressionString(): invalid condition \"${condition}\" from expressionString \"${expressionString}\"`);\r\n      return null;\r\n    }\r\n  \r\n    return {\r\n      condition: condition,\r\n      criteria: Number(percentageSplit[0]),\r\n      isPercent: percentageSplit.length > 1\r\n    } as WhenNumber;\r\n  } catch(e){\r\n    console.error(`could not parse expressionString \"${expressionString}\", expressionStrings must use one \r\n    of the following operators: [<=,<,=,>,>=] and follow a format like \"<=_10%\"`);\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const evaluateWhenNumber = (whenNumber: WhenNumber, reference: number, referenceMax: number) => {\r\n  try{\r\n    const referenceValue = whenNumber.isPercent ? \r\n      Math.round((reference / referenceMax) * 100)\r\n      : reference;\r\n    return EXPRESSION_MAP[whenNumber.condition](referenceValue, whenNumber.criteria);\r\n  }catch(e){\r\n    console.log(`could not evaluate \"whenNumber:${whenNumber}\", \"reference:${reference}\", \"referenceMax:${reference}\"`);\r\n    return null;\r\n  }\r\n};\r\n\r\n","// slightly evolving from create-react-app example\r\nimport { createSelector, createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { stat } from 'fs';\r\nimport { PetDefinition, SavedPetState, PetLogicGroup, RawPetJSON, PetStatusDefinition, PetInfo, PetBehaviorDefinition, PetStatDefinitionJSON, PetInteractionDefinition, StatChangeDefinition, PetInteractionDetail, LocalStorageState, ActiveInteractionStatus, DeltaStat, PetBehaviorJSON, CachedPetStat, PingPayload, PetStatDefinition } from '../../types';\r\nimport { clamp, getRenderedDeltaStats, getCachedDeltaStats } from '../../util/tools';\r\nimport { evaluateWhenThenNumberGroup, evaluateWhenThenStringGroup, parseRawWhenThenGroup } from '../../util/whenthen';\r\n\r\nimport { RootState } from '../store';\r\n\r\nconst DEFAULT_LOCALSTORAGE_STATE: LocalStorageState = {\r\n  config:{\r\n    activePet: '',\r\n    lastSaved: -1\r\n  },\r\n  interactions:[],\r\n  pets:[]\r\n};\r\n\r\nexport type PetStoreState = {\r\n  activeIdx: number,\r\n  pets: PetDefinition[],\r\n  interactions: ActiveInteractionStatus[],\r\n  cachedPets: SavedPetState[],\r\n  lastRendered: number,\r\n  lastSaved: number,\r\n}\r\n\r\nexport type CreatePetPayload = {\r\n  isActive: boolean,\r\n  petDefinition: RawPetJSON,\r\n  initialState: SavedPetState\r\n}\r\n\r\nconst initialStoreState: PetStoreState = {\r\n  activeIdx: -1,\r\n  pets: [],\r\n  interactions: [],\r\n  cachedPets: [],\r\n  lastRendered: new Date().getTime(),\r\n  lastSaved: new Date().getTime(),\r\n};\r\n\r\n// might want to do some validation and pre-processing here\r\nexport const parseLogicGroup = (petDefJSON: RawPetJSON, initialState: SavedPetState) => {\r\n  return {\r\n    stats: parseStatsGroup(petDefJSON.logic.stats, initialState),\r\n    statuses: petDefJSON.logic.statuses || [],\r\n    behaviorRules: parseRawWhenThenGroup(petDefJSON.logic.behaviorRules, 'statuses'),\r\n    behaviors: parsePetBehaviors(petDefJSON.logic.behaviors || [], petDefJSON.baseUrl),\r\n    interactions: parseInteractionsGroup(petDefJSON.logic.interactions, initialState),\r\n  } as PetLogicGroup;\r\n};\r\n\r\nexport const parsePetBehaviors = (petBehaviorsJson: PetBehaviorJSON[], baseUrl: string) => {\r\n  return petBehaviorsJson.map(pB => ({\r\n    ...pB,\r\n    imageUrl: pB.image ? `${baseUrl}/${pB.image}` : pB.imageUrl || '',\r\n    position: pB.position ? pB.position : 'center',\r\n    offsetX: pB.offsetX ? pB.offsetX : 0,\r\n    offsetY: pB.offsetY ? pB.offsetY : 0\r\n  }))\r\n}\r\n\r\n// could do some validation here\r\nexport const parseStatChanges = (statChangesJSON: StatChangeDefinition[] = []) => {\r\n  return statChangesJSON.map(sE => ({\r\n    statId: sE.statId,\r\n    value: sE.value || 0\r\n  }));\r\n}\r\n\r\nexport const parseInteractionsGroup = (interactions: PetInteractionDefinition[], initialState: SavedPetState) => {\r\n  if(!interactions) return [];\r\n\r\n  return interactions.map(int => (\r\n    {\r\n      id: int.id,\r\n      label: int.label,\r\n      cooldown: int.cooldown,\r\n      changeStats: parseStatChanges(int.changeStats)\r\n    }\r\n  ));\r\n};\r\n\r\nexport const parseStatsGroup = (statsDef: PetStatDefinitionJSON[], initialState: SavedPetState) => {\r\n  return statsDef.map(pS => {\r\n    const foundStat = initialState?.stats.find(iS => iS.id === pS.id);\r\n    const statEffects = parseRawWhenThenGroup(pS.statEffects, 'stats');\r\n\r\n    if(foundStat){\r\n      return {\r\n        ...pS,\r\n        value: foundStat.value,\r\n        statEffects: statEffects\r\n      }\r\n    }else{\r\n      return {\r\n        ...pS,\r\n        statEffects: statEffects\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nexport const getWasntTracked = (previous: SavedPetState[], activeIdx: number) => {\r\n  try{\r\n    return !previous[activeIdx].beingTracked\r\n  }catch(e){\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const getUpdatedStats = (cachedPetStats: CachedPetStat[], statDefinitions: DeltaStat[], newStats: StatChangeDefinition[]) => {\r\n  const getNewValue = (cachedStat: CachedPetStat, statDefs: DeltaStat[], changeDefs: StatChangeDefinition[]) => {\r\n    const found = changeDefs.find(cD => cD.statId === cachedStat.id);\r\n    if(!found) return cachedStat.value;\r\n\r\n    const rawNew = cachedStat.value + found.value;\r\n    const max = statDefs.find(sD => cachedStat.id === sD.id)?.max;\r\n    if(max){\r\n      return clamp(rawNew, 0, max);\r\n    }\r\n    return rawNew > 0 ? rawNew : 0;\r\n  }\r\n\r\n  return cachedPetStats.map(oldStat => ({\r\n    id: oldStat.id,\r\n    value: getNewValue(oldStat, statDefinitions, newStats)\r\n    // value: newStats.find(newStat => newStat.id === oldStat.id)?.value || oldStat.value\r\n  }));\r\n}\r\n\r\nexport const getNewStats = (oldStats: DeltaStat[], statChanges: StatChangeDefinition[]) => {\r\n  return oldStats.map(stat => {\r\n    const toChange = statChanges.find(sChange => sChange.statId === stat.id);\r\n    if(toChange){\r\n      return {\r\n        id: stat.id,\r\n        value: clamp(stat.value + toChange.value, 0, stat.max)\r\n      };\r\n    }\r\n    return stat;\r\n  });\r\n}\r\n\r\nexport const hackySave = (state: PetStoreState, explicitTime?:number) => {\r\n  const nowTime = (explicitTime !== undefined) ? explicitTime : new Date().getTime();\r\n  state.lastSaved = nowTime;\r\n  state.lastRendered = nowTime;\r\n}\r\n\r\n\r\nexport const petStoreSlice = createSlice({\r\n  name: 'petStore',\r\n  initialState: initialStoreState,\r\n  reducers: {\r\n    pingStore: (state: PetStoreState, action: PayloadAction<PingPayload>) => {\r\n      const nowTime = action.payload.time;\r\n\r\n      state.lastRendered = nowTime;\r\n      if(action.payload.doSave){\r\n        // console.log('update lastSaved');\r\n        state.lastSaved = nowTime;\r\n      }\r\n    },\r\n    clearSave: (state: PetStoreState) => {\r\n      // TODO, this should be handled differently, or taken out of redux otherwise\r\n      (global as any).localStorage.clear();\r\n      (global as any).location.reload();\r\n    },\r\n    setActiveId: (state: PetStoreState, action: PayloadAction<any>) => {\r\n      const petIdx = state.pets.findIndex((p:PetDefinition) => p.id === action.payload);\r\n      if(petIdx === -1){\r\n        console.log(`Cannot find pet with id \"${action.payload}\"`);\r\n      }else{\r\n        state.activeIdx = petIdx;\r\n\r\n        // TODO: this seems sketchy\r\n        hackySave(state);\r\n      }\r\n    },\r\n    setActiveIdx: (state: PetStoreState, action: PayloadAction<any>) => {\r\n      state.activeIdx = action.payload;\r\n\r\n      // TODO: this seems sketchy\r\n      hackySave(state);\r\n    },\r\n    setCachedPayload: (state: PetStoreState, action: PayloadAction<any>) => {\r\n      const lsState = action.payload as LocalStorageState;\r\n      state.cachedPets = lsState.pets;\r\n    },\r\n    restoreInteractionFromSave:  (state: PetStoreState, action: PayloadAction<any>) => {\r\n      const interaction = action.payload as ActiveInteractionStatus;\r\n      if(!state.interactions.find(iE => iE.id === interaction.id)){\r\n        console.log(`restoreInteractionFromSave ${interaction.id} with ${(interaction.endAt - new Date().getTime()) / 1000} secs left`);\r\n        state.interactions.push(interaction);\r\n      }\r\n    },\r\n    addNewInteractionEvent: (state: PetStoreState, action: PayloadAction<any>) => {\r\n      const { interaction, time } = action.payload as {\r\n        interaction: PetInteractionDefinition,\r\n        time: number\r\n      };\r\n\r\n      let doSave = false;\r\n      // interaction has to sit a bit, so save it for later\r\n      if(interaction.cooldown){\r\n        doSave = true;\r\n        // // these are added by a user interaction\r\n        if(!state.interactions.find(iE => iE.id === interaction.id)){\r\n          state.interactions.push({\r\n            id: interaction.id,\r\n            startAt: time,\r\n            endAt: time + (interaction.cooldown || 0)\r\n          });\r\n        }\r\n      }\r\n      \r\n      if(interaction.changeStats.length > 0){\r\n        doSave = true;\r\n        const activePet = state.pets[state.activeIdx];\r\n        const cachedIdx = state.cachedPets.findIndex(cP => cP.id === activePet.id);\r\n        if(cachedIdx > -1){\r\n          const cachedStats = state.cachedPets[cachedIdx]?.stats || [];\r\n          const statDefs = activePet.logic.stats;\r\n        \r\n          state.cachedPets[cachedIdx] = {\r\n            ...state.cachedPets[cachedIdx],\r\n            stats: getUpdatedStats(cachedStats, statDefs, interaction.changeStats)\r\n          }\r\n        }\r\n      }\r\n\r\n      if(doSave){\r\n        hackySave(state, time);\r\n      }\r\n    },\r\n    removeInteractionEvent: (state: PetStoreState, action: PayloadAction<any>) => {\r\n      const intId = action.payload as string;\r\n      \r\n      state.interactions = state.interactions.filter(interaction => interaction.id !== intId);\r\n    },\r\n    createPet: (state: PetStoreState, action: PayloadAction<any>) => {\r\n      console.log('\\n\\ncreatePet', action.payload);\r\n      const { petDefinition, initialState, isActive } = action.payload as CreatePetPayload;\r\n      const foundPet = state.pets.find(p => p.id === petDefinition.id);\r\n      const nowTime = new Date().getTime();\r\n      const logicGroup = parseLogicGroup(petDefinition, initialState);\r\n\r\n\r\n      console.log(`>> createPet: ${petDefinition.id}, isActive? ${isActive}, beingTracked? ${initialState?.beingTracked}`);\r\n      if(!initialState){\r\n        console.log('no initial state found.')\r\n      }else{\r\n        console.log('initial state:', initialState);\r\n      }\r\n\r\n      const updatedDef = {\r\n        ...petDefinition,\r\n        logic: logicGroup,\r\n        bornOn: initialState?.bornOn || nowTime,\r\n        bgImage: petDefinition.backgroundImage ? `${petDefinition.baseUrl}/${petDefinition.backgroundImage}` : null\r\n      } as PetDefinition;\r\n\r\n      if(foundPet){\r\n        state.pets = state.pets.map(p => {\r\n          if(p.id === petDefinition.id){\r\n            return updatedDef;\r\n          }else{\r\n            return p;\r\n          }\r\n        });\r\n      }else{\r\n        state.pets.push(updatedDef);\r\n      }\r\n\r\n      \r\n      // restore it to the cache if it was saved!\r\n      if(initialState){\r\n        if(!state.cachedPets.find(cP => cP.id === initialState?.id)){\r\n          state.cachedPets = [...state.cachedPets, ...[{\r\n            ...initialState,\r\n            lastSaved: initialState?.lastSaved || nowTime\r\n          }]]\r\n        }\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\nexport const { pingStore, createPet, setActiveIdx, setActiveId, clearSave, setCachedPayload, addNewInteractionEvent, restoreInteractionFromSave, removeInteractionEvent } = petStoreSlice.actions;\r\n\r\nexport const selectActiveIdx = (state: RootState): number => state.petStore.activeIdx;\r\nexport const selectPets = (state: RootState): PetDefinition[] => state.petStore.pets;\r\nexport const getActiveInteractions = (state: RootState): ActiveInteractionStatus[] => state.petStore.interactions;\r\nexport const getCachedPets = (state: RootState): SavedPetState[] => state.petStore.cachedPets;\r\nexport const getNewLastRendered = (state: RootState): number => state.petStore.lastRendered;\r\nexport const getNewLastSaved = (state: RootState): number => state.petStore.lastSaved;\r\n\r\nexport const selectLastSaved = createSelector(\r\n  [getNewLastSaved], (lastSaved) => lastSaved\r\n);\r\nexport const selectLastRendered = createSelector(\r\n  [getNewLastRendered], (lastRendered) => lastRendered\r\n);\r\n\r\nexport const selectActivePet = createSelector(\r\n  [selectPets, selectActiveIdx],\r\n  (pets, activeIdx) => {\r\n    return pets[activeIdx] || null;\r\n  }\r\n);\r\nexport const selectActiveStatDefinitions = createSelector(\r\n  [selectActivePet], (activePet) => activePet?.logic?.stats || []\r\n);\r\nexport const selectActiveStatusDefinitions = createSelector(\r\n  [selectActivePet], (activePet) => activePet?.logic?.statuses || []\r\n);\r\nexport const selectActiveInteractionDefinitions = createSelector(\r\n  [selectActivePet], (activePet) => activePet?.logic?.interactions || []\r\n);\r\nexport const selectActiveBehaviorRuleDefinitions = createSelector(\r\n  [selectActivePet], (activePet) => activePet?.logic?.behaviorRules || []\r\n);\r\nexport const selectActiveBehaviorDefinitions = createSelector(\r\n  [selectActivePet], (activePet) => activePet?.logic?.behaviors || []\r\n);\r\nexport const selectActiveBg = createSelector(\r\n  [selectActivePet], (activePet) => activePet?.bgImage\r\n);\r\nexport const selectCachedPets = createSelector(\r\n  [getCachedPets], (cachedPets) => cachedPets\r\n);\r\nexport const selectCachedPetStats = createSelector(\r\n  [getCachedPets], (cachedPets) => cachedPets.map(cp => cp.stats)\r\n);\r\nexport const selectActiveCachedPetStats = createSelector(\r\n  [getCachedPets, selectActivePet],\r\n  (cachedPets, activePet): CachedPetStat[] => {\r\n    if(!activePet) return [];\r\n    return cachedPets.find(cP => cP.id === activePet.id)?.stats || [];\r\n  }\r\n);\r\n\r\nexport const selectActiveInfo = createSelector(\r\n  [selectActivePet],\r\n  (activePet): (PetInfo | null) => {\r\n    if(!activePet) return null;\r\n\r\n    return {\r\n      id: activePet.id,\r\n      name: activePet.name,\r\n      level: activePet.level,\r\n      bio: activePet.bio,\r\n      bornOn: activePet.bornOn\r\n    };\r\n  }\r\n);\r\n\r\n\r\nexport const selectActiveInteractionStatus = createSelector(\r\n  [getActiveInteractions], (activeInteractions:ActiveInteractionStatus[]) => activeInteractions\r\n);\r\n\r\nexport const selectActiveLastCached = createSelector(\r\n  [getCachedPets, selectActivePet],\r\n  (cachedPets, activePet): number => {\r\n    // console.log('< selectActiveLastCached', cachedPets);\r\n    if(!activePet) return 0;\r\n    return cachedPets.find(cP => cP.id === activePet.id)?.lastSaved || 0;\r\n  }\r\n);\r\n\r\nexport const selectRenderedDeltaStats = createSelector(\r\n  [selectActiveStatDefinitions, selectActiveCachedPetStats, selectActiveLastCached, selectLastRendered], \r\n  (statDefinitions, cachedStats, petTime, time) => {\r\n    return getRenderedDeltaStats(statDefinitions, cachedStats, petTime, time);\r\n  }\r\n);\r\n\r\nexport const selectActiveInteractionDetail = createSelector(\r\n  [selectActiveInteractionDefinitions, selectActiveInteractionStatus], \r\n  (activeInteractionDefinitions, activeInteractions): PetInteractionDetail[] => { \r\n    return activeInteractionDefinitions.map(iD => {\r\n      return {\r\n        id:iD.id,\r\n        label: iD.label,\r\n        startAt: activeInteractions.find(aI => aI.id === iD.id)?.startAt || 0,\r\n        endAt: activeInteractions.find(aI => aI.id === iD.id)?.endAt || 0\r\n      } as PetInteractionDetail\r\n    }); \r\n  }\r\n);\r\n\r\nexport const selectActiveDeltaStatuses = createSelector(\r\n  [selectRenderedDeltaStats, selectActiveStatDefinitions], \r\n  (deltaStats, statDefinitions) => {\r\n    // for each statDef, look through statDef.statEffects, which is a whenThenNumberGroup[]\r\n    // all stats should be evaluated, and output all unique statuses matched\r\n    const findDeltaStat = (id: string) => deltaStats.find(ds => ds.id === id);\r\n\r\n    const allStatuses = [];\r\n    for(let i = 0; i < statDefinitions.length; i++){\r\n      const dS = findDeltaStat(statDefinitions[i].id);\r\n      if(!dS) continue;\r\n\r\n      for(let j = 0; j < statDefinitions[i].statEffects.length; j++){\r\n        const status = evaluateWhenThenNumberGroup(statDefinitions[i].statEffects[j], dS.value, dS.max);\r\n        if(status && allStatuses.indexOf(status) === -1){\r\n          allStatuses.push(status);\r\n        }\r\n      }\r\n    }\r\n    return allStatuses.map((statusId, idx) => {\r\n      return statusId\r\n    }).reverse();\r\n  }\r\n);\r\n\r\nexport const selectDetailedActiveDeltaStatuses = createSelector(\r\n  [selectActiveDeltaStatuses, selectActiveStatusDefinitions],\r\n  (deltaStatIds, statusDefinitions): PetStatusDefinition[] => {\r\n    return deltaStatIds.map(dId => {\r\n      return statusDefinitions.find(sD => sD.id === dId) as PetStatusDefinition;\r\n    }).filter(e => !!e);\r\n  }\r\n);\r\n\r\nexport const selectActiveBehavior = createSelector(\r\n  [selectActiveDeltaStatuses, selectActiveBehaviorRuleDefinitions, selectActiveBehaviorDefinitions],\r\n  (deltaStatusIds, behaviorRules, behaviorDefinitions): (PetBehaviorDefinition | null) => {\r\n    for(let i = 0; i < behaviorRules.length; i++){\r\n      let finalBehaviorId = evaluateWhenThenStringGroup(behaviorRules[i], deltaStatusIds);\r\n      if(finalBehaviorId){\r\n        const f = behaviorDefinitions.find(bD => bD.id === finalBehaviorId);\r\n        if(!f){\r\n          console.log(`ERROR: invalid behaviorId: \"${finalBehaviorId}\"`);\r\n          return null;\r\n        }\r\n        return f;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n);\r\n\r\nexport const selectPetList = createSelector(\r\n  [selectPets, selectActiveIdx],\r\n  (pets, activeIdx) => pets.map((p, idx) => ({\r\n    name: p.name,\r\n    id: p.id,\r\n    isActive: idx === activeIdx\r\n  }))\r\n);\r\n\r\nexport const selectCachedDeltaStats = createSelector(\r\n  [selectActiveStatDefinitions, selectActiveCachedPetStats, selectActiveLastCached, selectLastSaved], \r\n  (petStats, cachedPetStats, lastCachedTime, lastSavedTime) => {\r\n    if(lastCachedTime === lastSavedTime) return null;\r\n    return getCachedDeltaStats(petStats, cachedPetStats, lastCachedTime, lastSavedTime);\r\n  }\r\n);\r\n\r\nexport const getFromLocalStorage = () => {\r\n  try{\r\n    return JSON.parse((global as any).localStorage.getItem('browserpet'));\r\n  }catch(e){\r\n    console.log('no localStorage entry found for \"browserpet\"');\r\n    return null;\r\n  }\r\n}\r\nexport const getPetsFromLocalStorage = () => {\r\n  try{\r\n    return getFromLocalStorage().pets;\r\n  } catch(e){\r\n    return [];\r\n  }\r\n}\r\n\r\n\r\nexport const selectPetsFromLocalStorage = createSelector(\r\n  [getPetsFromLocalStorage], (pets: SavedPetState[]) => pets\r\n);\r\n\r\n// TODO, the beingTracked here needs to be investigated more.\r\nexport const selectNewSavePayload = createSelector(\r\n  [selectLastSaved, selectCachedDeltaStats, selectActivePet, selectActiveInteractionStatus, selectCachedPets],\r\n  (lastSaved, cachedDeltaStats, activePet, activeInteractions, storedPets): (LocalStorageState | null) => {\r\n    \r\n    //TODO, this seems fishy\r\n    if(!cachedDeltaStats){\r\n      return null;\r\n    }\r\n\r\n    if(!activePet){\r\n      return DEFAULT_LOCALSTORAGE_STATE;\r\n    }\r\n    \r\n    const foundIdx = storedPets.findIndex((sP: SavedPetState) => sP.id === activePet.id);\r\n    let newList = [];\r\n    if(foundIdx > -1){\r\n      newList = storedPets.map((sP: SavedPetState) => {\r\n        if(sP.id === activePet.id){\r\n          const curStats = sP.beingTracked ? cachedDeltaStats : sP.stats;\r\n          \r\n          return {\r\n            id: activePet.id,\r\n            stats: curStats,\r\n            bornOn: activePet.bornOn,\r\n            lastSaved: lastSaved,\r\n            beingTracked: true\r\n          }\r\n        }\r\n\r\n        return {\r\n          ...sP,\r\n          beingTracked:false\r\n        };\r\n      })\r\n    }else{\r\n      newList = storedPets.concat([{\r\n        id: activePet.id,\r\n        stats: cachedDeltaStats,\r\n        bornOn: activePet.bornOn,\r\n        lastSaved: lastSaved,\r\n        beingTracked: false\r\n      }]);\r\n    }\r\n\r\n    // console.log('>> returning savedPayload', newList);\r\n    \r\n    return {\r\n      config:{\r\n        activePet: activePet?.id || '',\r\n        lastSaved: lastSaved\r\n      },\r\n      interactions:activeInteractions,\r\n      pets:newList\r\n    };\r\n  }\r\n);\r\n\r\n\r\nexport default petStoreSlice.reducer;\r\n"],"sourceRoot":""}